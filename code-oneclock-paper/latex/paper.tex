\documentclass[a4paper,UKenglish,cleveref, autoref,numberwithinsect]{lipics-v2019}

\title{Guarded Recursion in Agda via Sized Types}

\author{Niccol\`o Veltri}{Department of Computer Science, IT
  University of Copenhagen, Denmark}{nive@itu.dk}{https://orcid.org/0000-0002-7230-3436}{This work was supported by a research grant (13156) from VILLUM FONDEN,
  and by DFF-Research Project 1 Grant no. 4002-00442, from The Danish Council 
  for Independent Research for the Natural Sciences (FNU).}

\author{Niels van der Weide}{Institute for Computation and Information Sciences, Radboud University, Nijmegen, The Netherlands}{nweide@cs.ru.nl}{https://orcid.org/0000-0003-1146-4161}{}

\authorrunning{N. Veltri and N. van der Weide}%TODO mandatory. First: Use abbreviated first/middle names. Second (only in severe cases): Use first author plus 'et al.'

\Copyright{Niccol\`o Veltri, Niels van der Weide}

\ccsdesc[100]{Theory of Computation~Type Theory}
\ccsdesc[100]{Theory of Computation~Categorical Semantics}%TODO mandatory: Please choose ACM 2012 classifications from https://dl.acm.org/ccs/ccs_flat.cfm 

\keywords{guarded recursion, type theory, semantics, coinduction, sized types}%TODO mandatory; please add comma-separated list of keywords

\category{}%optional, e.g. invited paper

\relatedversion{}%optional, e.g. full version hosted on arXiv, HAL, or other respository/website
%\relatedversion{A full version of the paper is available at \url{...}.}

\supplement{}%optional, e.g. related research data, source code, ... hosted on a repository like zenodo, figshare, GitHub, ...

%\funding{(Optional) general funding statement \dots}%optional, to capture a funding statement, which applies to all authors. Please enter author specific funding statements as fifth argument of the \author macro.

\acknowledgements{We are thankful to Andreas Abel, Guillaume Allais, Herman Geuvers,
  Rasmus Ejlers M{\o}gelberg and Andrea Vezzosi for discussions and
valuable hints.}%optional

%\nolinenumbers %uncomment to disable line numbering

%\hideLIPIcs  %uncomment to remove references to LIPIcs series (logo, DOI, ...), e.g. when preparing a pre-final version to be uploaded to arXiv or another public repository

%Editor-only macros:: begin (do not touch as author)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\EventEditors{John Q. Open and Joan R. Access}
\EventNoEds{2}
\EventLongTitle{42nd Conference on Very Important Topics (CVIT 2016)}
\EventShortTitle{CVIT 2016}
\EventAcronym{CVIT}
\EventYear{2016}
\EventDate{December 24--27, 2016}
\EventLocation{Little Whinging, United Kingdom}
\EventLogo{}
\SeriesVolume{42}
\ArticleNo{23}

\usepackage{csquotes}
\usepackage[all,cmtip]{xy}

%%%%%%%%%%%%%   AMS MATH  %%%%%%%%%%%%%%
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtools}

\usepackage[noinputencodingsetup]{agda}

% The following packages are needed because unicode
% is translated (using the next set of packages) to
% latex commands. You may need more packages if you
% use more unicode characters:

\usepackage{amssymb}
\usepackage{bbm}

\usepackage{newunicodechar}
\usepackage{stmaryrd}

% This handles the translation of unicode to latex:


% Some characters that are not automatically defined
% (you figure out by the latex compilation errors you get),
% and you need to define:

\newunicodechar{‚ä§}{$\top$}
\newunicodechar{‚â°}{$\equiv$}
\newunicodechar{‚ÇÅ}{$_1$}
\newunicodechar{‚ÇÇ}{$_2$}
\newunicodechar{‚ÇÉ}{$_3$}
\newunicodechar{Œì}{$\Gamma$}
\newunicodechar{Œî}{$\Delta$}
\newunicodechar{Œ£}{$\Sigma$}
\newunicodechar{Œ±}{$\alpha$}
\newunicodechar{Œ≤}{$\beta$}
\newunicodechar{Œ∑}{$\eta$}
\newunicodechar{Œ≥}{$\gamma$}
\newunicodechar{Œµ}{$\varepsilon$}
\newunicodechar{Œ∏}{$\theta$}
\newunicodechar{Œª}{$\lambda$}
\newunicodechar{Œº}{$\mu$}
\newunicodechar{Œ∫}{$\kappa$}
\newunicodechar{œÄ}{$\pi$}
\newunicodechar{‚àà}{$\in$}
\newunicodechar{‚äû}{$\boxplus$}
\newunicodechar{‚ä†}{$\boxtimes$}
\newunicodechar{‚àÅ}{$\mathbb{C}$}
\newunicodechar{‚ñ∫}{$\blacktriangleright$}
\newunicodechar{‚ñª}{$\vartriangleright$}
\newunicodechar{ùüô}{\textbf{1}}
\newunicodechar{‚àô}{$\cdot$}
\newunicodechar{‚àÄ}{$\forall$}
\newunicodechar{‚Ñì}{$\ell$}
\newunicodechar{‚àÖ}{$\varnothing$}
\newunicodechar{‚ü∂}{$\rightarrow$}
\newunicodechar{‚ñ°}{$\square$}
\newunicodechar{‚á°}{$\uparrow$}
\newunicodechar{‚äõ}{$\circledast$}
\newunicodechar{‚äé}{$\uplus$}
\newunicodechar{‚ü®}{$\langle$}
\newunicodechar{‚ü©}{$\rangle$}
\newunicodechar{‚ñ†}{$\blacksquare$}
\newunicodechar{‚àé}{$\blacksquare$}
\newunicodechar{‚áí}{$\Rightarrow$}
\newunicodechar{‚äï}{$\oplus$}
\newunicodechar{‚äó}{$\otimes$}
\newunicodechar{‚àº}{$\sim$}
\newunicodechar{‚âà}{$\approx$}
\newunicodechar{‚äî}{$\sqcup$}
\newunicodechar{‚ü¶}{$\llbracket$}
\newunicodechar{‚üß}{$\rrbracket$}
\newunicodechar{‚ä•}{$\bot$}
\newunicodechar{‚àû}{$\infty$}
\newunicodechar{‚áë}{$\Uparrow$}
\newunicodechar{‚âÉ}{$\simeq$}
\newunicodechar{‚àò}{$\circ$}
% Add more as you need them (shouldn't happen often).

\newcommand{\AD}[1]{\AgdaDatatype{#1}}
\newcommand{\AIC}[1]{\AgdaInductiveConstructor{#1}}
\newcommand{\AF}[1]{\AgdaFunction{#1}}
\newcommand{\AFi}[1]{\AgdaField{#1}}
\newcommand{\AB}[1]{\AgdaBound{#1}}
%\newcommand{\full}[1]{} %for the conference version
\newcommand{\full}[1]{#1} % for the full version

% New commands for Agda inline code
\newcommand{\D}{\AgdaDatatype}
\newcommand{\IC}{\AgdaInductiveConstructor}
\newcommand{\F}{\AgdaFunction}
\newcommand{\Ar}{\AgdaArgument}
\newcommand{\Fi}{\AgdaField}

\newcommand{\remove}[1]{}

\newcommand{\ie}{\emph{i.e.,} }
\newcommand{\cf}{\emph{c.f.} }
\newcommand{\eg}{\emph{e.g.,} }
\newcommand{\etal}{\emph{et~al.}}
\newcommand{\etc}{\emph{etc.}}
\newcommand{\wrt}{w.r.t.~}
\newcommand{\resp}{resp.~}
\newcommand{\loccit}{\emph{loc. cit.} }

\newcommand{\GTT}{\textbf{GTT}}

%This is a template for producing LIPIcs articles. 
%See lipics-manual.pdf for further information.
%for A4 paper format use option "a4paper", for US-letter use option "letterpaper"
%for british hyphenation rules use option "UKenglish", for american hyphenation rules use option "USenglish"
% for section-numbered lemmas etc., use "numberwithinsect"

\usepackage{microtype}%if unwanted, comment out or use option "draft"

%\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory

\usepackage{cleveref}

\bibliographystyle{plainurl}% the mandatory bibstyle

\newcommand{\NV}[1]{\textcolor{green}{NV: #1}}
\newcommand{\NW}[1]{\textcolor{orange}{NW: #1}}

\begin{document}

\maketitle

\begin{abstract}
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent convallis orci arcu, eu mollis dolor. Aliquam eleifend suscipit lacinia. Maecenas quam mi, porta ut lacinia sed, convallis ac dui. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse potenti. 
 \end{abstract}

\section{Introduction}
\label{sec:intro}
\input{Introduction}
%\nocite{*}

\section{The Host Type Theory}
\label{sec:prelim}
\input{Prelude/Basics}
%% \input{Presheaves/Presheaves}
%% \input{Presheaves/Const}
%% \input{Presheaves/Terminal}
%% \input{Presheaves/Product}
%% \input{Presheaves/Sum}
%% \input{Presheaves/Exp}
%% \input{CloTT/Structure/Contexts}
%% \input{CloTT/Structure/Types}
%% \input{CloTT/Structure/Terms}
%% \input{CloTT/Structure/DefinitionalEquality}
%% \input{CloTT/Structure/ContextOperations}
%% \input{CloTT/Structure/Subst}
%% \input{CloTT/TypeFormers/UnitType}
%% \input{CloTT/TypeFormers/SumType}
%% \input{CloTT/TypeFormers/ProductType}
%% \input{CloTT/TypeFormers/FunctionType}
%% \input{CloTT/TypeFormers/ClockQuantification}
%% \input{CloTT/TypeFormers/Later}
%% \input{CloTT/TypeFormers/LaterType}
%% \input{CloTT/TypeFormers/WeakenClock}
%% \input{CloTT/TypeFormers/Fix}
%% \input{CloTT/TypeFormers/Force}

%% \input{allcode}
%\subsection{Sized Types}

\section{The Object Type Theory}
\label{sec:syntax}
\input{Prelude/Syntax}
\input{Streams}

\section{Categorical Semantics}

Next we define categorical semantics for the syntax defined in \Cref{sec:syntax}.
To do so, we use a similar method as used by M{\o}gelberg \cite{Mogelberg14}.
The interpretation of types depend on the clock contexts.
If the clock context is empty, then types become sets.
If the clock context has one clock, then types are interpreted as objects in the topos of trees.

\label{sec:presheaf_sem}
\subsection{Presheaves}
\label{sec:presheaves}
\input{Presheaves/Presheaves}

\input{Presheaves/NaturalTransformations}

\input{Presheaves/Const}
\input{Presheaves/Exp}

\subsection{Modelling Simple Types}
%\label{sec:kripke}
\input{CloTT/Structure/Contexts}

\input{CloTT/Structure/Types}

\input{CloTT/Structure/Terms}

\input{CloTT/Structure/Subst}

\input{CloTT/Structure/DefinitionalEquality}

\input{CloTT/Structure/ContextOperations}

Lastly, we use operations on sets and presheaves to define the type operators in simple type theory.
For sets, we use products, sums, and function types in Agda.
Products, sums, and exponentials of presheaves are interpreted with the operations in \Cref{sec:presheaves}.
We only give the notation for function types.

\input{CloTT/TypeFormers/FunctionType}

\section{Modelling Guarded Recursion}
\label{sec:guarded}
Now we have the simple type formers and their terms.
The next step is to add the type formers required for guarded recursion.
We start by defining clock quantification and the later modality, and how to construct terms of those types.
With this in place, we define the fixpoint combinator.
In the end, we give the type former for guarded recursive types.

\subsection{Context Weakening and Clock Quantification}
\input{CloTT/TypeFormers/WeakenClock}
\input{CloTT/TypeFormers/ClockQuantification}

\subsection{The Later Modality}
\label{sec:later}
\input{CloTT/TypeFormers/Later}
\input{CloTT/TypeFormers/Fix}
\input{CloTT/TypeFormers/Force}

\subsection{Guarded Recursive Types}
\input{CloTT/TypeFormers/Mu}

\section{Consistency}
\input{GuardedTT}

\section{Conclusion}
We formally defined a syntax of guarded type theory with explicit substitutions and weakening, and we constructed denotational semantics for it in type theory extended with sized types.
From this, we concluded that this theory is consistent and that guarded recursion can be defined via sized types.

There are several possible ways to improve on this result.
First of all, one could define a dependent version of this type theory extended with multiple clocks.
This can be done in two ways.
Either one extends the object theory with delayed substitutions \cite{bizjak2016guarded} or with ticks \cite{BahrGM17}.
Second of all, with the deep embedding in place, one can further study the meta-theory by defining a formalized type checking and a normalization algorithm.

%%
%% Bibliography
%%

%% Please use bibtex, 

\bibliography{literature}


\end{document}
